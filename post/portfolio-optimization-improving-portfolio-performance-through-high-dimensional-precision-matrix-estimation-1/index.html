<html>
  <head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Improving Portfolio Performance Through High-dimensional Precision Matrix Estimation (1) | OptiMaeve</title>
<link rel="shortcut icon" href="https://Maeve-L.github.io/favicon.ico?v=1585057995881">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://Maeve-L.github.io/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>



  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://Maeve-L.github.io">
  <img class="avatar" src="https://Maeve-L.github.io/images/avatar.png?v=1585057995881" alt="">
  </a>
  <h1 class="site-title">
    OptiMaeve
  </h1>
  <p class="site-description">
    Personal and professional integrity should always be consistent.
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          Home
        </a>
      
    
      
        <a href="/archives" class="menu">
          Archives
        </a>
      
    
      
        <a href="/tags" class="menu">
          Tags
        </a>
      
    
      
        <a href="/post/about" class="menu">
          About
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>


        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Improving Portfolio Performance Through High-dimensional Precision Matrix Estimation (1)
            </h2>
            <div class="post-info">
              <time class="post-time">
                · 2020-03-24 ·
              </time>
              
            </div>
            
            <div class="post-content">
              <p>This project focused the market structure using two-sample tests for high dimensional means and covariance and proposed approaches for tackling the instability of optimization solutions to improve the Markowitz model.</p>
<p>The following part was finished by Mingzhen Yang, Peking University.</p>
<!-- more -->
<h2 id="introduction">Introduction</h2>
<p>In this paper, we propose approaches for tackling the instability of optimization solutions to improve the Markowitz model. We study the market structure using two-sample tests for high dimensional means and covariance, which motivates us to improve the basic framework for the mean-variance approach. Despite the simplicity of the mean-variance optimization, estimating the input parameters introduces the estimation errors, leading to the instability of portfolio weights. We present two estimation strategies for high-dimensional inverse covariance matrix estimation. Moreover, we propose penalization methods like Lasso and ridge regression from another perspective to regularize the inverse of the covariance matrix. In the end, we report the results of our empirical analysis conducted on a high dimensional dataset of stocks comprised in the CSI 300 index.</p>
<h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>We study on a dataset made of the daily returns of the stocks comprised in CSI 300 Index between Jan 2010 and Nov 2019. After dropping the stocks with missing values, we select 176 stocks for high-dimensional sample tests. The dataset consists of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>176</mn></mrow><annotation encoding="application/x-tex">p=176</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">6</span></span></span></span> stocks and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>2661</mn></mrow><annotation encoding="application/x-tex">n=2661</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">6</span><span class="mord">6</span><span class="mord">1</span></span></span></span> observations.</p>
<h3 id="two-sample-tests-for-high-dimensional-means">Two-Sample Tests for High Dimensional Means</h3>
<p>We first conduct two-sample tests for multivariate means between any two years from 2010 to 2019. Since the result of the Shapiro-Wilk Test rejects the hypothesis of a normal distribution for every stock in our data set, we carry out Chen and Qin (2010) Test and visualize the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>-value in the below figure.</p>
<p>Most of the time, the overall return levels of the Chinese stock market between two years in the recent decade are similar. Given significant level of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0.05</mn></mrow><annotation encoding="application/x-tex">0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span></span></span></span>, we have 6 pairs which show different returns between two years:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>2011</mn><mo separator="true">,</mo><mn>2014</mn><mo>)</mo><mo separator="true">,</mo><mo>(</mo><mn>2011</mn><mo separator="true">,</mo><mn>2017</mn><mo>)</mo><mo separator="true">,</mo><mo>(</mo><mn>2011</mn><mo separator="true">,</mo><mn>2019</mn><mo>)</mo><mo separator="true">,</mo><mo>(</mo><mn>2013</mn><mo separator="true">,</mo><mn>2014</mn><mo>)</mo><mo separator="true">,</mo><mo>(</mo><mn>2014</mn><mo separator="true">,</mo><mn>2018</mn><mo>)</mo><mo separator="true">,</mo><mo>(</mo><mn>2017</mn><mo separator="true">,</mo><mn>2018</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(2011,2014), (2011,2017), (2011,2019), (2013,2014), (2014,2018), (2017,2018)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">9</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">8</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span><span class="mord">8</span><span class="mclose">)</span></span></span></span> Actually, they are all the pair of a bull year and a bear year, which is consistent with our intuition.</p>
<figure data-type="image" tabindex="1"><img src="https://Maeve-L.github.io/post-images/1585052821900.png" alt="p-value of Chen Qin Test"></figure>
<p>We also conduct the adjusted Chen-Qin Test, which calculates the p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Chen et al. (2014) based on permutation or parametric bootstrap resampling and speeds up the original test. The results are presented below.</p>
<figure data-type="image" tabindex="2"><img src="https://Maeve-L.github.io/post-images/1585052903572.png" alt="p-value of Speeded-up Chen Qin Test"></figure>
<h3 id="adjusted-t-test-for-each-dimension">Adjusted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> Test for Each Dimension</h3>
<p>We then do <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>-tests for each stock's return in each pair of years listed above. We use Bonferroni and Benjamini-Hochberg correction to adjust the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>-value of tests.</p>
<p>As is shown, the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>-value adjusted by Benjamini-Hochberg correction is more conservative and there are just a small number of stocks that have significantly different returns in 2011 and 2014. However, considering that stock return data is not strictly normally distributed, the efficacy of multiple <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>-tests should be carefully considered.</p>
<figure data-type="image" tabindex="3"><img src="https://Maeve-L.github.io/post-images/1585053268190.png" alt="Adjusted p-value for year 2011 and 2014: Benjamini-Hochberg correction"></figure>
<figure data-type="image" tabindex="4"><img src="https://Maeve-L.github.io/post-images/1585053296250.png" alt="Adjusted p-value for year 2011 and 2014: Bonferroni correction"></figure>
<h3 id="two-sample-tests-for-high-dimensional-covariance-matrices">Two Sample Tests for High-dimensional Covariance Matrices</h3>
<p>We now want to have a look at the dependent relationship between stocks in recent years. First, we could have an intuitive feeling of the changes in market correlation by comparing the heat maps of correlation matrices in different years. It is presented that market risk structure, as well as risk aggregation in the Chinese market, has varied in recent 10 years. The dependence among stock was relatively strong in the years 2015 and 2016. In 2017, we could see that the relationship of stocks was weak compared with others, and some of the stocks are negatively correlated with others. In fact, when the dependence among the stocks is strengthened, systematic risk is increasing too, which imposes a threat to the investors' investment portfolio which is built based on the risk calculation.</p>
<figure data-type="image" tabindex="5"><img src="https://Maeve-L.github.io/post-images/1585053572489.png" alt="Correlation matrices of Chinese stocks in recent 10 years"></figure>
<p>To further validate our findings, we carry out tests to test the equality of covariance matrices for the stock returns between any two years in the recent decade. We use the high dimensional covariance matrices equality test by Li and Chen (2012) using a linear combination of three one-sample U statistics and an unbiased estimator of the Frobenius norm of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mn>1</mn></msub><mo>−</mo><msub><mi mathvariant="normal">Σ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\Sigma_{1}-\Sigma_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, which is of good test power without the hypothesis of normal distribution. And we also try the test raised by Cai et al. (2013) using the maximum norm, which focuses on sparse alternatives.</p>

            </div>
          </article>
        </div>

        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://Maeve-L.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

      </div>
    </div>
  </body>
</html>
